name: sample_get

ddev_version_constraint: ">=1.22.0"

pre_install_actions:
- |
  cat <<EOF >.ddev/config.platformsh.yaml
  php_version: {{ trimPrefix "php:" .platformapp.type }}
  database: 
    type: {{ regexReplaceAll ":.*$" .services.db.type "" }}
    version: {{ regexReplaceAll "^.*:" .services.db.type "" }}
    
  docroot: {{ dig "web" "locations" "/" "root" "notfound" .platformapp }}
  {{ if eq .platformapp.build.flavor "composer" }}
  hooks:
    post-start:
      - composer: install
  {{ if .platformapp.hooks.deploy }}
      - exec: "{{ trimAll "\n" .platformapp.hooks.deploy | splitList "\n" | join ` && ` }}"
  {{ end }}
  {{ end }}
    
  EOF

project_files:
- junk_${DDEV_GOOS}_${DDEV_GOARCH}.txt
- extra

global_files:

post_install_actions:

yaml_read_files:
  platformapp: .platform.app.yaml
  services: .platform/services.yaml
