#ddev-generated

http:
  routers:
    {{$appname := .App.Name}}{{$hostnames := .Hostnames}}{{ range $s := .RoutingTable }}
    {{$appname}}-{{$s.InternalServiceName}}-{{$s.InternalServicePort}}:
      rule: "Host({{ range $i, $h := $hostnames }}{{if $i}}, {{end}}`{{$h}}`{{end}})"
      service: {{$s.InternalServiceName}}-{{$s.InternalServicePort}}"
      tls: false
      entrypoints:
        - web
    {{ end }}

#    {{.App.Name}}-https:
#      rule: "Host({{ range $i, $h := .Hostnames }}{{if $i}}, {{end}}`{{$h}}`{{end}})"
#      service: "ddev-{{.App.Name}}-web-https"
#      tls: true
#      entrypoints:
#        - web-secure

  services:
    {{$appname := .App.Name}}
    {{ range $s := .RoutingTable }}
    {{ $s.InternalServiceName }}-{{ $s.InternalServicePort }}:
      loadbalancer:
        servers:
          - url: http://ddev-{{$appname}}-{{$s.InternalServiceName}}:{{$s.InternalServicePort}}
    {{ end }}
    ddev-{{.App.Name}}-web-https:
      loadbalancer:
        servers:
          - url: http://ddev-{{.App.Name}}-web

tls:
  certificates:
    - certFile: {{ .TargetCertsPath }}/{{ .App.Name }}.crt
      keyFile: {{ .TargetCertsPath }}/{{ .App.Name }}.key
